---
title: Configuring CORS
description: Control access to your server's resources
---

[Cross-Origin Resource Sharing](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS) (CORS) is an HTTP-header based protocol that enables a server to dictate which origins have access to its resources. Put another way, your server can specify which websites can use a user's browser to talk to your server, and precisely which types of HTTP requests are allowed.

## Why use CORS?

Most developers know about CORS because they run into the all-too-common [CORS error](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS/Errors). CORS errors usually occur when you set up an API call or try to get your separately hosted server and client to talk to each other. To better understand what CORS is and why we use it, we'll briefly go over some background context.

It's common knowledge that all internet users need to think carefully before installing any new software on their devices. However, when it comes to websites, we navigate to different sites all the time, letting our browsers load content from those sites along the way.

As web developers, we aim to have users navigate to our website, but we don't want the user's browser to do anything fishy to our server while the user is visiting. Browser security mechanisms (e.g., CORS or SOP) can give developers peace of mind by enabling a website's server to specify which browser's origins can request resources from that server.

The [_origin_](https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy#definition_of_an_origin) of a piece of web content consists of that content's domain, protocol, and port. The [same-origin policy](https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy) (SOP) is a security mechanism that restricts scripts on one origin from interacting with resources from another origin.

If two URLs differ in their domain, protocol, or port, then those URLs come from two different origins:
```bash
# Same origin
http://example.com:8080/ <==> http://example.com:8080/

# Different origin (difference in domain, protocol, and port)
http://example.com:8080/ =X= https://example1.com:8081/
```


However, as we all know, the internet is an exciting place full of resources that can make websites better (importing images, extra fonts, making API calls, etc.).  Developers needed a new protocol to relax SOP and safely _share_ resources across different origins.

Cross-Origin Resource Sharing is the mechanism that allows a web page to  _share_ resources across different origins. CORS provides an extra layer of protection by enabling servers and clients to define HTTP headers that specify _which_ external clients' scripts can access their resources.

Note that both SOP and CORS are related to [browser security](https://developer.mozilla.org/en-US/docs/Web/Security#security-related_glossary_terms); neither prevents other kinds of software from requesting resources from your server.

## Configuring CORS options for Apollo Server

By default, the batteries-included `apollo-server` package uses the wildcard value (`*`) to allow requests from any origin _without credentials_ to access its served responses.  We'll go into more detail about what this means below.

The batteries-included `apollo-server` [has a `cors` option](../api/apollo-server/#cors), which you can use to change your server's default CORS behavior:

```js
const server = new ApolloServer({
  typeDefs,
  resolvers,
  cors: {
    origin: ["https://www.your-app.example", "https://studio.apollographql.com"]
  },
});
```

The example above enables CORS requests from `https://www.your-app.example`, along with `https://studio.apollographql.com` (the origin for [Apollo Studio Explorer](https://www.apollographql.com/docs/studio/explorer/explorer/)).

If you're using another integration of Apollo Server, you can add the `cors` configuration option to your framework-specific middleware function to change your server's CORS behavior. To learn more about the CORS defaults and options for your integration of Apollo Server, see [CORS configuration options](../api/apollo-server/#cors-1).

Below is an example of setting up CORS with the [`apollo-server-express`](../integrations/middleware#swapping-out-apollo-server) package:

```js
// ... set up the server
await server.start();

const corsOptions = {
  origin: ["https://www.your-app.example", "https://studio.apollographql.com"]
};

server.applyMiddleware({
  app,
  cors: corsOptions,
  path: "/graphql",
});
```

### Configuring origins

CORS uses [specific HTTP request headers](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#the_http_response_headers) as part of its protocol, including [`Access-Control-Allow-Origin`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin)). The `Access-Control-Allow-Origin` header enables a server to dictate which origins can use scripts to access that server's resources. Using [`cors`](https://github.com/expressjs/cors#configuration-options) middleware, you can configure the `Access-Control-Allow-Origin` header using the `origin` option.

By default, the batteries-included `apollo-server` package uses the wildcard value (`*`) to allow requests from any origin _without credentials_ to access its served responses. This works great in development, allowing you to delay configuring CORS until your application is ready for production. You can also [remove CORS middleware entirely](../api/apollo-server#cors), disabling cross-origin requests.

> If you need to pass credentials to your server (e.g., via cookies or an HTTP header), you can't use the wildcard value (`*`) for your origin. You _must_ provide specific origins; see [Passing credentials with CORS](#passing-credentials-with-cors) for examples.

Below is an example of configuring the `origin` option with a list of specific origins that can access our server's responses:

```js
//  With the batteries-included Apollo Server
const server = new ApolloServer({
  typeDefs,
  resolvers,
  cors: {
    origin: ["https://www.your-app.example", "https://studio.apollographql.com"]
  },
});
```

> Note if you plan to use [Apollo Studio Explorer](https://www.apollographql.com/docs/studio/explorer/explorer/) as a GraphQL web IDE you should include `https://studio.apollographql.com` in your list of valid origins.

### Specifying origins in production

Depending on what you are building, you might want to change your CORS middleware's `origin` option when your project is ready for production.

If you create a public API or an API to embed in other websites, you probably want to allow _all_ origins to access your server's resources. You can use the default wildcard value (`*`) in these situations, allowing requests from any origin.

> If you use the wildcard value (`*`) in production, _any_ website can tell a user's browser to send an arbitrary request (without cookies or other credentials) to your server and read that server's response.

If you create an API on the public internet to serve resources to your _own_ website or app, you might want to specify which origins can access your server's resources. If your API needs to [send user credentials](#passing-credentials-with-cors) with requests, we strongly recommend specifying origins in your CORS configuration.

If your browser is running your API on a private network (i.e., not on the public internet), we **strongly recommend** specifying which origins can access your server's resources. This is to avoid enabling attackers to use your browser to send requests to servers on your private network.

## Passing credentials with CORS

If your cross-site requests [include a user's credentials](https://developer.mozilla.org/en-US/docs/Web/API/Request/credentials) (e.g., cookies or HTTP `Authentication` headers), you might need to modify your CORS configuration.

You can enable credentials with CORS by setting the [`Access-Control-Allow-Credentials`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials) HTTP header to `true`.

Using `cors` middleware, we can do this by setting the [`credentials`](https://github.com/expressjs/cors#configuration-options) option to `true`:

```js
//  The example below is using the apollo-server-express package.

// ... set up the server
await server.start();

const corsOptions = { origin: yourOrigin, credentials: true };

server.applyMiddleware({
  app,
  cors: corsOptions,
  path: "/graphql",
});
```

> You *must* specify an origin to enable credentialed requests (i.e., your origin can't use the `*` wildcard value).

The `cors` middleware `origin` option accepts a boolean value, which means you can configure CORS to allow all cross-origin requests _with_ credentials (i.e., `{origin: true, credentials: true}`). In production, we advise against this and strongly recommend [specifying origins in your CORS configuration](#configuring-origins).

For examples of sending cookies and authorization headers from Apollo Client, see [Authentication](/react/networking/authentication/). For more guidance on adding authentication logic to Apollo Server, see [Authentication and authorization](./authentication).
